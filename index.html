<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estudo Tracker</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="icon" type="image/png" href="static/images/icons8-stopwatch-50.png">
</head>
<!-- Mini Timer flutuante (fica fora das .tab para nÃ£o sumir) -->
<div id="miniTimer" class="mini-timer hidden" aria-live="polite">
  <div class="mini-time" id="miniDisplay">00:00:00</div>
  <div class="mini-actions">
    <button id="miniPause" class="mini-btn" aria-label="Pausar/Retomar">
      <i class="fas fa-pause"></i>
    </button>
    <button id="miniClose" class="mini-btn danger" aria-label="Fechar">
      <i class="fas fa-times"></i>
    </button>
  </div>
</div>

<body>
  <!-- Loader -->
  <div id="loader" class="loader">Carregando...</div>

  <!-- BotÃ£o tema -->
  <button id="themeToggle" class="theme-toggle" aria-label="Alternar tema">
    <i class="fas fa-moon"></i>
  </button>

  <!-- Topbar / NavegaÃ§Ã£o -->
  <header class="topbar">
    <nav class="tabs-nav">
      <button data-tab="timer"   class="nav-btn active" aria-label="Timer"><i class="fas fa-clock"></i></button>
      <button data-tab="metrics" class="nav-btn" aria-label="MÃ©tricas"><i class="fas fa-chart-bar"></i></button>
      <button data-tab="notes"    class="nav-btn" aria-label="Notas"><i class="fas fa-sticky-note"></i></button>
      <button data-tab="settings" class="nav-btn" aria-label="ConfiguraÃ§Ãµes"><i class="fas fa-gear"></i></button>
      <span class="nav-indicator"></span>
    </nav>
  </header>

  <!-- Barra de progresso semanal -->
  <div class="weekly-progress">
    <div class="weekly-progress-fill" id="weeklyFill"></div>
  </div>

  <!-- Resumo rÃ¡pido -->
  <div id="quickSummary" class="quick-summary">
    Hoje: 0h00min | Semana: 0h00min | Meta: 0h00min
  </div>

  <main>
    <!-- TAB TIMER -->
    <section id="tab-timer" class="tab active" aria-labelledby="Timer">
      <div class="timer-wrapper">
        <div class="timer-ring">
          <div class="planet"></div>
          <i class="fas fa-stopwatch timer-icon"></i>
          <div class="timer" id="display">00:00:00</div>
          <!-- Pizza progress indicator -->
          <div class="pizza"></div>
        </div>
      </div>

      <div class="timer-controls">
        <button id="plus5" class="icon-btn"><i class="fas fa-plus"></i> 5m</button>
        <button id="startBtn" class="icon-btn"><i class="fas fa-play"></i></button>
        <button id="resetBtn" class="icon-btn"><i class="fas fa-redo"></i></button>
        <button id="minus5" class="icon-btn"><i class="fas fa-minus"></i> 5m</button>
      </div>


      <!-- Pomodoro -->
      <div class="pomodoro-config">
        <label for="pomodoroFocus"><i class="fas fa-hourglass-half"></i></label>
        <input type="number" id="pomodoroFocus" min="1" step="1" value="25" />
        <label for="pomodoroBreak"><i class="fas fa-coffee"></i></label>
        <input type="number" id="pomodoroBreak" min="1" step="1" value="5" />
      </div>
      <div class="pomodoro-buttons">
        <button id="btnStartPomodoro"><i class="fas fa-play-circle"></i>Pomodoro</button>
      </div>

      <div class="streak-box">
        Streak: <span id="streakCounter">0</span>
        <div class="fire level1" aria-hidden="true"></div>
      </div>


      <h2>Timeline do Dia</h2>
      <div id="timelineContainer"></div>
    </section>

    <!-- TAB MÃ‰TRICAS -->
    <section id="tab-metrics" class="tab" aria-labelledby="MÃ©tricas">
      <div class="card">
        <h2>Horas Estudadas na Semana</h2>
        <div class="meta-container">
          <label for="metaHoras"><i class="fas fa-bullseye"></i> Meta semanal:</label>
          <input type="number" id="metaHoras" min="0" step="0.5" value="10" />
        </div>
        <div id="totalSemana" class="total-semana-box">Total da semana: 0:00</div>
          <table id="studyTable">
            <thead>
              <tr id="studyHeader"><!-- os dias vÃ£o aqui --></tr>
            </thead>
            <tbody>
              <tr id="studyValues"><!-- tempos + Ã­cones vÃ£o aqui --></tr>
            </tbody>
          </table>
      </div>

      <div class="charts card">
        <h2>GrÃ¡fico Acumulado Semanal</h2>
        <canvas id="chartAcumuladoSemanal"></canvas>

        <h2>HistÃ³rico de Metas Semanais</h2>
        <canvas id="chartMetaHistory"></canvas>

        <h2>Heatmap do MÃªs</h2>
        <div id="heatmapContainer"></div>

        <h2>AnÃ¡lise de Produtividade</h2>
        <canvas id="chartScatter"></canvas>
        <div id="insightsBox" class="card"></div>

        <button id="aiTipsBtn" class="icon-btn">ðŸ’¡ Obter Dicas</button>
        <div id="aiTipsOutput" class="card" style="white-space: pre-wrap; margin-top:1rem;"></div>
      </div>
    </section>

    <!-- TAB CONFIGURAÃ‡Ã•ES -->
    <section id="tab-settings" class="tab" aria-labelledby="ConfiguraÃ§Ãµes">
      <div class="card">
        <h2>Exportar / Importar Dados</h2>
        <button id="btnExport"><i class="fas fa-file-export"></i> Exportar JSON</button>
        <input type="file" id="importFile" accept="application/json" hidden />
        <button id="btnImport"><i class="fas fa-file-import"></i> Importar JSON</button>
      </div>

      <div class="card">
        <h2>Resetar Tudo</h2>
        <button id="btnHardReset" class="danger"><i class="fas fa-bomb"></i> Limpar LocalStorage</button>
      </div>

      <div class="card">
        <h2>NotificaÃ§Ãµes</h2>
        <label>
          <input type="checkbox" id="notifySound" /> Som ao terminar Pomodoro
        </label><br/>
        <label>
          <input type="checkbox" id="notifyVibrate" /> Vibrar ao terminar Pomodoro
        </label>
      </div>
    </section>

    <!-- TAB NOTAS -->
    <section id="tab-notes" class="tab" aria-labelledby="Notas">
      <div class="card notes-card">
        <h2><i class="fas fa-sticky-note"></i> Minhas Notas</h2>
        <textarea id="notesArea" placeholder="Escreva suas notas aqui..."></textarea>
        <div class="buttons">
          <button id="clearNotesBtn"><i class="fas fa-trash-alt"></i> Limpar Notas</button>
        </div>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <div id="sessionsModal" class="modal hidden">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>SessÃµes de Foco â€“ <span id="modalDate"></span></h2>
      <ul id="sessionsList"></ul>
    </div>
  </div>
  <script src="script.js"></script>
</body>
</html>
